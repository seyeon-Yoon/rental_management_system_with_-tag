# 렌탈 관리 시스템 (Rental Management System)

융합공과대학 학생회를 위한 무료 대여 서비스 관리 시스템

## 프로젝트 개요

융합공과대학 학생회에서 융공대 학생들에게 다양한 생활/학습 용품을 무료로 대여해주는 서비스를 효율적으로 관리하기 위한 웹 기반 시스템입니다.

## 요구사항 (Requirements)

### 1. 비즈니스 요구사항

#### 1.1 서비스 개요
- **운영 주체**: 융합공과대학 학생회
- **서비스 대상**: 융합공과대학 재학생 (대학교 API를 통한 자동 인증)
- **서비스 성격**: 무료 대여 서비스 (학생 복지 목적)
- **운영 방식**: 온라인 예약 + 오프라인 수령/반납

#### 1.2 대여 품목 카테고리
1. **운동용품** (관리자가 세부 품목 등록)
2. **전자기기**: 보조배터리, 공학용계산기
3. **생활용품**: 우산, 인공눈물, 상비약
4. **엔터테인먼트**: 보드게임
5. **학업용품**: 실험복

### 2. 기능 요구사항

#### 2.1 사용자 인증
- **필수**: 대학교 홈페이지 API 연동을 통한 융공대 학생 자동 인증
- **대안 없음**: API 연동이 전제 조건

#### 2.2 예약 시스템
- **실시간 재고 확인**: 예약 가능한 품목만 표시
- **온라인 예약**: 웹에서 품목 선택 및 예약
- **시간 제한**: 예약 후 1시간 내 학생회실 방문 필수
- **자동 취소**: 1시간 초과 시 예약 자동 취소 및 재고 복원

#### 2.3 대여 관리
- **대여 기간**: 모든 품목 최대 7일 (품목별 구분 없음)
- **동시 대여**: 한 학생당 여러 품목 동시 대여 가능 (개수 제한 없음)
- **반납 관리**: 반납 시 재고 자동 복원

#### 2.4 재고 관리
- **개별 추적**: 같은 품목도 개별 식별자로 구분 (예: 보조배터리#001, #002)
- **실시간 현황**: 대여/반납/예약 상태 실시간 반영
- **재고 알림**: 품목별 재고 부족 시 관리자 알림

#### 2.5 관리 기능
- **품목 관리**: 관리자가 카테고리별 세부 품목 등록/수정/삭제
- **대여 이력**: 학생별/품목별 대여 이력 조회
- **통계 대시보드**: 대여 현황, 인기 품목, 연체 현황 등

### 3. 사용자 권한

#### 3.1 학생 (일반 사용자)
- 실시간 재고 확인
- 온라인 예약
- 개인 대여 이력 조회
- 예약 취소

#### 3.2 관리자 (2명)
- 모든 학생 기능
- 품목 등록/수정/삭제
- 재고 관리
- 대여/반납 처리
- 전체 통계 및 이력 조회
- 시스템 설정 관리

### 4. 기술 요구사항

#### 4.1 성능 요구사항
- **응답 시간**: 일반 페이지 2초 이내, 예약 처리 1초 이내
- **동시 접속**: 최대 100명 동시 접속 지원
- **데이터 일관성**: 재고 관리 시 동시성 제어 필수

#### 4.2 보안 요구사항
- **인증**: JWT 기반 토큰 인증
- **인가**: 역할 기반 접근 제어 (RBAC)
- **데이터 보호**: 개인정보 암호화 저장
- **감사 로그**: 모든 대여/반납/관리 활동 로그 기록

#### 4.3 호환성
- **브라우저**: Chrome, Firefox, Safari 최신 버전
- **모바일**: 반응형 웹 디자인으로 모바일 접근 지원

### 5. 비기능 요구사항

#### 5.1 사용성
- **직관적 UI**: 학생들이 쉽게 사용할 수 있는 간단한 인터페이스
- **빠른 예약**: 3클릭 이내로 예약 완료
- **실시간 피드백**: 예약/대여/반납 상태 즉시 확인 가능

#### 5.2 신뢰성
- **가용성**: 99% 업타임 목표
- **데이터 백업**: 일일 자동 백업
- **장애 복구**: 시스템 장애 시 1시간 내 복구

#### 5.3 확장성
- **사용자 확장**: 향후 다른 학과 확장 고려
- **품목 확장**: 새로운 카테고리 추가 용이
- **기능 확장**: 알림 기능, 예약 대기열 등 추가 기능 고려

### 6. 제약사항

#### 6.1 개발 제약사항
- **개발 기간**: 1개월 (빠른 개발 우선)
- **예산**: 최소 비용 (오픈소스 기술 스택 선호)
- **인력**: 소규모 개발팀

#### 6.2 운영 제약사항
- **대학교 API 의존성**: 대학교 홈페이지 API 연동 필수 (대안 없음)
- **오프라인 연계**: 온라인 예약 + 오프라인 수령/반납 방식 고정
- **무료 서비스**: 수익 모델 없음 (학생 복지 목적)

### 7. 우선순위

#### 7.1 높음 (Must Have)
1. **재고 실시간 추적**: 정확한 재고 상태 관리
2. **예약 편의성**: 간단하고 빠른 예약 프로세스
3. **대학교 API 인증**: 융공대 학생 자동 인증

#### 7.2 중간 (Should Have)
1. **관리 업무 반자동화**: 관리자 업무 효율화
2. **대여 이력 관리**: 통계 및 분석 기능
3. **알림 시스템**: 예약/반납 알림

#### 7.3 낮음 (Nice to Have)
1. **모바일 앱**: 웹 기반으로 우선 개발
2. **고급 통계**: 상세 분석 기능
3. **다국어 지원**: 한국어 우선

---

## 개발 현황

### 완료된 단계
- ✅ **Phase 1**: 시스템 설계 및 아키텍처 (100%)
- ✅ **Phase 2**: 개발 환경 구축 (100%)
  - Docker 기반 개발 환경
  - FastAPI + React 프로젝트 구조
  - 데이터베이스 스키마 (6개 테이블)
- ✅ **Phase 3**: 핵심 백엔드 개발 (100%)
  - ✅ 인증 시스템 구현 완료
  - ✅ 품목 관리 API 구현 완료
  - ✅ 예약 시스템 API 구현 완료
  - ✅ 대여 관리 API 구현 완료
  - ✅ **백엔드 실행 환경 완성**: SQLite + FastAPI 서버 정상 실행
  - ✅ **Swagger API 문서**: `http://localhost:8000/docs` 접근 가능 (총 32개 엔드포인트)

- ✅ **Phase 4**: 프론트엔드 개발 지원 (100%)
  - ✅ **프론트엔드 아키텍처 가이드**: `docs/FRONTEND_DEVELOPMENT_GUIDE.md` (400+ 줄)
    - React 18 + TypeScript + Material-UI 완전 설계
    - 피처 기반 컴포넌트 구조, TanStack Query 상태 관리
    - JWT 인증 및 보호된 라우트 패턴
  - ✅ **API 통합 가이드**: `docs/API_USAGE_EXAMPLES.md` (300+ 줄)
    - 32개 모든 엔드포인트 사용법 예제
    - 인증 플로우, 에러 처리, TypeScript 타입 정의
  - ✅ **UI/UX 설계 시스템**: `docs/UI_DESIGN_GUIDE.md` (500+ 줄)
    - 전체 페이지 와이어프레임 (로그인부터 관리자 대시보드)
    - Material-UI 컴포넌트 설계, 한국어 최적화, 모바일 우선 반응형
  - ✅ **샘플 데이터 완비**: `backend/scripts/seed_sample_data.py`
    - 7명 사용자, 8개 카테고리, 22개 품목, 다양한 예약/대여 시나리오

### 진행 중
- 🔄 **Phase 5**: 프론트엔드 구현 (25% 완료)
  - ✅ React 개발환경 구축 완료
  - 🔄 핵심 사용자 기능 구현 중

### 다음 단계 (예정)  
- 📋 **Phase 6**: 통합 및 테스트
- 📋 **Phase 7**: 배포 및 운영
- 📋 **Phase 8**: 사용자 테스트 및 최적화

### 마일스톤
- **1주차 말**: Phase 2 완료 ✅
- **2주차 말**: Phase 3 완료 ✅  
- **3주차 초**: Phase 4 완료 ✅ (프론트엔드 지원 문서)
- **3주차 말**: Phase 5 진행 중 🔄 (프론트엔드 구현)
- **4주차 말**: Phase 6-8 완료 예정 (테스트, 배포, 최적화)



## 시스템 아키텍처

### 기술 스택

**백엔드**
- **FastAPI** (Python): 빠른 개발, 자동 API 문서화, 타입 힌트
- **PostgreSQL**: 관계형 데이터, ACID 보장, 동시성 제어
- **Redis**: 세션 관리, 예약 시간 제한 처리
- **SQLAlchemy**: ORM, 데이터베이스 추상화

**프론트엔드**
- **React + TypeScript**: 컴포넌트 재사용, 타입 안정성
- **Material-UI (MUI)**: 빠른 UI 구현, 반응형 디자인
- **React Router**: 클라이언트 사이드 라우팅
- **TanStack Query (React Query)**: 서버 상태 관리, 캐싱
- **Axios**: HTTP 클라이언트, API 통신
- **Day.js**: 날짜/시간 처리 (한국어 로케일 지원)

**인프라**
- **Docker + Docker Compose**: 개발 환경 일관성
- **Nginx**: 리버스 프록시, 정적 파일 서빙

### 시스템 구조

```
[ 대학교 API ] ← 인증 연동
     ↕
[ Frontend (React) ]
     ↕ HTTP/REST
[ API Gateway (FastAPI) ]
     ↕
[ Business Logic Layer ]
     ↕
[ Data Access Layer (SQLAlchemy) ]
     ↕
[ PostgreSQL ] ← [ Redis (세션/캐시) ]
```

### 데이터베이스 스키마

#### 주요 테이블 구조

**1. users (사용자)**
- 학생 정보 및 관리자 권한 관리
- 대학교 API 연동을 통한 인증 정보 저장

**2. categories (카테고리)**
- 8개 대여 품목 카테고리 관리
- 확장 가능한 구조로 새 카테고리 추가 용이

**3. items (품목)**
- 개별 품목 추적 (serial_number로 구분)
- 상태 관리 (AVAILABLE/RESERVED/RENTED/MAINTENANCE)

**4. reservations (예약)**
- 온라인 예약 관리
- 1시간 시간 제한 및 자동 취소 처리

**5. rentals (대여)**
- 실제 대여 기록 및 반납 관리
- 7일 대여 기간 추적

**6. audit_logs (감사 로그)**
- 모든 시스템 활동 로그 기록
- 데이터 변경 이력 추적

##### 확장성 고려사항

- **유연한 품목 관리**: JSONB 메타데이터로 품목별 특수 속성 저장
- **다학과 확장**: department 컬럼으로 학과별 구분 가능
- **비즈니스 규칙 확장**: 카테고리별/품목별 대여 기간 설정 가능
- **알림 시스템**: 추후 notifications 테이블 추가 예정
- **무중단 확장**: PostgreSQL 마이그레이션으로 스키마 변경 지원

### 프론트엔드 구조

#### 컴포넌트 구조
```
src/
├── components/
│   ├── common/          # 공통 컴포넌트
│   │   ├── Layout.tsx
│   │   ├── Header.tsx
│   │   └── ProtectedRoute.tsx
│   ├── item/           # 품목 관련
│   │   ├── ItemCard.tsx
│   │   └── ItemList.tsx
│   ├── reservation/    # 예약 관련
│   └── admin/          # 관리자 전용
├── pages/              # 페이지 컴포넌트
├── hooks/              # 커스텀 훅
├── services/           # API 서비스
├── contexts/           # React Context
├── types/              # TypeScript 타입 정의
└── utils/              # 유틸리티 함수
```

#### 주요 기능
- **인증 시스템**: JWT 토큰 기반 인증, 학교 API 연동, Redis 세션 관리
- **상태 관리**: React Context (전역 상태) + TanStack Query (서버 상태)
- **라우팅**: React Router 기반 보호된 라우트
- **UI/UX**: Material-UI 컴포넌트, 반응형 디자인
- **타입 안전성**: TypeScript로 컴파일 타임 타입 검증

## API 개요

현재 총 **32개 API 엔드포인트**가 구현 완료되어 백엔드 시스템이 완성되었습니다.

- **Swagger 문서**: `http://localhost:8000/docs`
- **상세 API 문서**: [`docs/API_DOCUMENTATION.md`](docs/API_DOCUMENTATION.md)
- **API 사용 예제**: [`docs/API_USAGE_EXAMPLES.md`](docs/API_USAGE_EXAMPLES.md)

### 구현 완료된 API 그룹
- ✅ **인증 API** (4개): 로그인/로그아웃, 토큰 관리, 사용자 조회
- ✅ **품목 관리 API** (14개): 카테고리/품목 CRUD, 검색, 통계
- ✅ **예약 시스템 API** (8개): 예약 생성/취소, 1시간 제한 관리
- ✅ **대여 관리 API** (8개): 대여/반납 처리, 연장, 연체 관리

---

## 프론트엔드 개발 시작 가이드

프론트엔드 개발자는 다음 순서로 개발을 시작할 수 있습니다:

### 1단계: 백엔드 실행 및 API 확인
```bash
# 1. 백엔드 실행 (이미 실행 중이면 생략)
cd backend
python3 -m uvicorn main:app --reload --port 8000 --host 0.0.0.0

# 2. Swagger API 문서 확인
# 브라우저에서 http://localhost:8000/docs 접속

# 3. 샘플 데이터 로드 (필요시)
python3 scripts/seed_sample_data.py
```

### 2단계: 개발 가이드 문서 숭지
- **아키텍처 가이드**: `docs/FRONTEND_DEVELOPMENT_GUIDE.md` 전체 읽기
- **API 가이드**: `docs/API_USAGE_EXAMPLES.md`에서 인증 플로우 및 API 사용법 학습
- **UI 가이드**: `docs/UI_DESIGN_GUIDE.md`에서 전체 화면 설계 및 컴포넌트 명세 확인

### 3단계: React 프로젝트 설정
```bash
# frontend 디렉토리에 React 프로젝트 생성
npx create-react-app frontend --template typescript
cd frontend

# 필수 라이브러리 설치
npm install @mui/material @emotion/react @emotion/styled
npm install @mui/icons-material
npm install @tanstack/react-query
npm install react-router-dom
npm install axios
npm install dayjs
```

### 4단계: 개발 시작
`docs/FRONTEND_DEVELOPMENT_GUIDE.md`의 "구현 순서" 섹션에 따라 단계적으로 개발:

1. **기본 설정** - 로우터, 타입, Context 설정
2. **인증 시스템** - 로그인, JWT 토큰 관리
3. **공통 컴포넌트** - Layout, Header, 로딩
4. **학생 기능** - 품목 목록, 예약, 내 이력
5. **관리자 기능** - 대시보드, 품목 관리

---

## 🚀 실행 방법

현재 시스템은 **Docker 실행**과 **로컬 실행** 두 가지 방식을 모두 지원합니다.

### 🐳 Docker 실행 (프로덕션/배포용)

완전한 프로덕션 환경으로 모든 서비스를 컨테이너로 실행합니다.

```bash
# 전체 시스템 실행
docker-compose up

# 백그라운드 실행
docker-compose up -d

# 접속
# - 웹사이트: http://localhost (Nginx 통해서)
# - API 문서: http://localhost:8000/docs  
# - 프론트엔드: http://localhost:3000
```

**Docker 환경 구성:**
- **PostgreSQL**: 데이터베이스 (포트 5432)
- **Redis**: 세션 캐시 (포트 6379)
- **Backend**: FastAPI 서버 (포트 8000)
- **Frontend**: React 개발서버 (포트 3000)
- **Nginx**: 리버스 프록시 (포트 80)

### 💻 로컬 실행 (개발용) ⭐ 현재 활성화됨

빠른 개발과 테스트를 위한 로컬 환경입니다.

```bash
# 1. 백엔드 실행 (SQLite 사용)
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# 2. 프론트엔드 실행 (별도 터미널)
cd frontend  
npm install  # 최초 1회만
npm start

# 접속
# - 프론트엔드: http://localhost:3000
# - API 문서: http://localhost:8000/docs
```

**로컬 환경 특징:**
- **SQLite**: 파일 기반 데이터베이스 (`rental_system.db`)
- **빠른 시작**: 의존성 최소화, 즉시 개발 가능
- **자동 새로고침**: 코드 변경 시 자동 재시작
- **샘플 데이터**: 테스트용 계정 및 품목 데이터 포함

### 📋 샘플 데이터 및 테스트 계정

로컬 실행 시 다음 테스트 계정을 사용할 수 있습니다:

```bash
# 샘플 데이터 생성 (최초 1회)
cd backend
python scripts/seed_sample_data.py
```

**테스트 계정:**
- **관리자**: 2024001 (김관리), 2024002 (이운영)
- **학생**: 2024101~2024105 (박학생, 최융공 등)
- **비밀번호**: 모든 계정 `test123`

**샘플 품목:** 22개 품목 (운동용품, 전자기기, 생활용품 등)

### 🔄 환경 전환 가이드

#### 로컬 → Docker 전환:
1. `frontend/package.json`에서 proxy를 `"http://backend:8000"`으로 변경
2. `.env`의 DATABASE_URL을 PostgreSQL로 변경
3. `docker-compose up` 실행

#### Docker → 로컬 전환:
1. `frontend/package.json`에서 proxy를 `"http://localhost:8000"`으로 변경  
2. `.env`의 DATABASE_URL을 SQLite로 변경
3. 로컬 서버들 개별 실행

---

## 📝 최근 업데이트 (2025-08-30)

### Phase 5 프론트엔드 구현 시작
- **React 개발환경 구축 완료**: TypeScript, Material-UI, 백엔드 API 연동 테스트 완료
- **브라우저 테스트 완료**: Playwright 자동 테스트 및 수동 브라우저 테스트 성공
- **개발 환경 이슈 해결**: TypeScript 버전 호환성, 프록시 설정, import 경로 등 해결
- **다음 단계**: React 컴포넌트 실제 구현 시작

---

**최종 수정일**: 2025-08-30  
**작성자**: 윤세연